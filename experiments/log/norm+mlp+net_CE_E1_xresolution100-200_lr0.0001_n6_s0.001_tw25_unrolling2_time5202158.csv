Training on dataset data/CE_train_E1.h5
Specified device: cuda:0
Using NVIDIA A100 80GB PCIe
models/GNN_norm+mlp+net_CE_E1_xresolution100-200_lr0.0001_n6_s0.001_tw25_unrolling2_time5202158.tar
Number of parameters: 1035587
Saved initial model at models/init5202158.pt
Epoch 0
Starting epoch 0...
=========================================================================================================
Positions transformed for neighbours of Node 6 (for each GNN layer):

Node: 00 (pos: 0.000): -2.01994e-02, -1.00306e-02, -1.71341e-02, -1.10881e-01, 5.02473e-02, 1.70077e-01
Node: 01 (pos: 0.010): -2.13185e-02, -1.08192e-02, -1.63037e-02, -1.10002e-01, 4.97094e-02, 1.69917e-01
Node: 02 (pos: 0.020): -2.24392e-02, -1.16138e-02, -1.54685e-02, -1.09120e-01, 4.91737e-02, 1.69770e-01
Node: 03 (pos: 0.030): -2.35614e-02, -1.24143e-02, -1.46284e-02, -1.08233e-01, 4.86401e-02, 1.69638e-01
Node: 04 (pos: 0.040): -2.46852e-02, -1.32208e-02, -1.37833e-02, -1.07343e-01, 4.81088e-02, 1.69519e-01
Node: 05 (pos: 0.051): -2.58105e-02, -1.40330e-02, -1.29332e-02, -1.06448e-01, 4.75795e-02, 1.69415e-01
-
Node: 07 (pos: 0.071): -2.58105e-02, -1.40330e-02, -1.29332e-02, -1.06448e-01, 4.75795e-02, 1.69415e-01
Node: 08 (pos: 0.081): -2.46852e-02, -1.32208e-02, -1.37833e-02, -1.07343e-01, 4.81088e-02, 1.69519e-01
Node: 09 (pos: 0.091): -2.35614e-02, -1.24143e-02, -1.46284e-02, -1.08233e-01, 4.86401e-02, 1.69638e-01
Node: 10 (pos: 0.101): -2.24392e-02, -1.16138e-02, -1.54685e-02, -1.09120e-01, 4.91737e-02, 1.69770e-01
Node: 11 (pos: 0.111): -2.13185e-02, -1.08192e-02, -1.63037e-02, -1.10002e-01, 4.97094e-02, 1.69917e-01
Node: 12 (pos: 0.121): -2.01994e-02, -1.00306e-02, -1.71341e-02, -1.10881e-01, 5.02473e-02, 1.70077e-01

Kernel Weights for neighbours of Node 6 (for each GNN layer):

Node: 00 (pos: 0.000): 6.64968e-01, 9.04283e-01, 7.45593e-01, 4.57671e-06, 8.00748e-02, 2.73819e-13
Node: 01 (pos: 0.010): 6.34779e-01, 8.89536e-01, 7.66583e-01, 5.55676e-06, 8.44982e-02, 2.89196e-13
Node: 02 (pos: 0.020): 6.04401e-01, 8.73820e-01, 7.87198e-01, 6.74215e-06, 8.90951e-02, 3.03963e-13
Node: 03 (pos: 0.030): 5.73991e-01, 8.57173e-01, 8.07357e-01, 8.17478e-06, 9.38682e-02, 3.17943e-13
Node: 04 (pos: 0.040): 5.43698e-01, 8.39635e-01, 8.26977e-01, 9.90482e-06, 9.88202e-02, 3.30963e-13
Node: 05 (pos: 0.051): 5.13666e-01, 8.21253e-01, 8.45973e-01, 1.19923e-05, 1.03954e-01, 3.42858e-13
-
Node: 07 (pos: 0.071): 5.13666e-01, 8.21253e-01, 8.45973e-01, 1.19923e-05, 1.03954e-01, 3.42858e-13
Node: 08 (pos: 0.081): 5.43698e-01, 8.39635e-01, 8.26977e-01, 9.90482e-06, 9.88202e-02, 3.30963e-13
Node: 09 (pos: 0.091): 5.73991e-01, 8.57173e-01, 8.07357e-01, 8.17478e-06, 9.38682e-02, 3.17943e-13
Node: 10 (pos: 0.101): 6.04401e-01, 8.73820e-01, 7.87198e-01, 6.74215e-06, 8.90951e-02, 3.03963e-13
Node: 11 (pos: 0.111): 6.34779e-01, 8.89536e-01, 7.66583e-01, 5.55676e-06, 8.44982e-02, 2.89196e-13
Node: 12 (pos: 0.121): 6.64968e-01, 9.04283e-01, 7.45593e-01, 4.57671e-06, 8.00748e-02, 2.73819e-13
---------------------------------------------------------------------------------------------------------
Positions transformed for neighbours of Node 56 (for each GNN layer):

Node: 00 (pos: 0.000): -2.58105e-02, -1.40330e-02, -1.29332e-02, -1.06448e-01, 4.75795e-02, 1.69415e-01
Node: 01 (pos: 0.010): -2.46852e-02, -1.32208e-02, -1.37833e-02, -1.07343e-01, 4.81088e-02, 1.69519e-01
Node: 02 (pos: 0.020): -2.35614e-02, -1.24143e-02, -1.46284e-02, -1.08233e-01, 4.86401e-02, 1.69638e-01
Node: 03 (pos: 0.030): -2.24392e-02, -1.16138e-02, -1.54685e-02, -1.09120e-01, 4.91737e-02, 1.69770e-01
Node: 04 (pos: 0.040): -2.13185e-02, -1.08192e-02, -1.63037e-02, -1.10002e-01, 4.97094e-02, 1.69917e-01
Node: 05 (pos: 0.051): -2.01994e-02, -1.00306e-02, -1.71341e-02, -1.10881e-01, 5.02473e-02, 1.70077e-01
-
Node: 07 (pos: 0.071): -2.13185e-02, -1.08192e-02, -1.63037e-02, -1.10002e-01, 4.97094e-02, 1.69917e-01
Node: 08 (pos: 0.081): -2.24392e-02, -1.16138e-02, -1.54685e-02, -1.09120e-01, 4.91737e-02, 1.69770e-01
Node: 09 (pos: 0.091): -2.35614e-02, -1.24143e-02, -1.46284e-02, -1.08233e-01, 4.86401e-02, 1.69638e-01
Node: 10 (pos: 0.101): -2.46852e-02, -1.32208e-02, -1.37833e-02, -1.07343e-01, 4.81088e-02, 1.69519e-01
Node: 11 (pos: 0.111): -2.58105e-02, -1.40330e-02, -1.29332e-02, -1.06448e-01, 4.75795e-02, 1.69415e-01
Node: 12 (pos: 0.121): -2.01994e-02, -1.00306e-02, -1.71341e-02, -1.10881e-01, 5.02473e-02, 1.70077e-01

Kernel Weights for neighbours of Node 56 (for each GNN layer):

Node: 57 (pos: 0.576): 5.13666e-01, 8.21253e-01, 8.45973e-01, 1.19923e-05, 1.03954e-01, 3.42858e-13
Node: 58 (pos: 0.586): 5.43698e-01, 8.39635e-01, 8.26977e-01, 9.90482e-06, 9.88202e-02, 3.30963e-13
Node: 59 (pos: 0.596): 5.73991e-01, 8.57173e-01, 8.07357e-01, 8.17478e-06, 9.38682e-02, 3.17943e-13
Node: 60 (pos: 0.606): 6.04401e-01, 8.73820e-01, 7.87198e-01, 6.74215e-06, 8.90951e-02, 3.03963e-13
Node: 61 (pos: 0.616): 6.34779e-01, 8.89536e-01, 7.66583e-01, 5.55676e-06, 8.44982e-02, 2.89196e-13
Node: 50 (pos: 0.505): 6.64968e-01, 9.04283e-01, 7.45593e-01, 4.57671e-06, 8.00748e-02, 2.73819e-13
-
Node: 51 (pos: 0.515): 6.34779e-01, 8.89536e-01, 7.66583e-01, 5.55676e-06, 8.44982e-02, 2.89196e-13
Node: 52 (pos: 0.525): 6.04401e-01, 8.73820e-01, 7.87198e-01, 6.74215e-06, 8.90951e-02, 3.03963e-13
Node: 53 (pos: 0.535): 5.73991e-01, 8.57173e-01, 8.07357e-01, 8.17478e-06, 9.38682e-02, 3.17943e-13
Node: 54 (pos: 0.545): 5.43698e-01, 8.39635e-01, 8.26977e-01, 9.90482e-06, 9.88202e-02, 3.30963e-13
Node: 55 (pos: 0.556): 5.13666e-01, 8.21253e-01, 8.45973e-01, 1.19923e-05, 1.03954e-01, 3.42858e-13
Node: 62 (pos: 0.626): 6.64968e-01, 9.04283e-01, 7.45593e-01, 4.57671e-06, 8.00748e-02, 2.73819e-13
=========================================================================================================
Training Loss (progress: 0.00), 1.3272904826720275, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.08), 0.2617541555682549, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.16), 0.20359647372406284, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.24), 0.1730145252763144, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.32), 0.16323257425805032, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.40), 0.1419157316091401, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.48), 0.13845758414409237, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.56), 0.12697251122759964, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.64), 0.11793303440954979, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.72), 0.11187080169934761, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.80), 0.11226353916815708, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.88), 0.11037345678141451, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.96), 0.11016650214242213, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Evaluation on validation dataset:
Step 25, mean loss 0.0800674496873867
Step 50, mean loss 0.07160398557737577
Step 75, mean loss 0.09127190841615843
Step 100, mean loss 0.2481438736652873
Step 125, mean loss 0.20905402501914133
Step 150, mean loss 0.17467165205955798
Step 175, mean loss 0.3261612910079257
Step 200, mean loss 0.6925692560053154
Step 225, mean loss 0.5773304701833137
Unrolled forward losses 11.381466876623408
Unrolled forward base losses 2.565701273852575
=========================================================================================================
Positions transformed for neighbours of Node 6 (for each GNN layer):

Node: 00 (pos: 0.000): -1.16212e-01, 9.05280e-02, -7.00337e-02, -5.96198e-02, 1.41645e-01, 1.55055e-01
Node: 01 (pos: 0.010): -1.16743e-01, 7.15205e-02, -5.74792e-02, -4.86972e-02, 1.40656e-01, 1.54910e-01
Node: 02 (pos: 0.020): -1.17275e-01, 5.30310e-02, -4.45072e-02, -3.74732e-02, 1.39669e-01, 1.54778e-01
Node: 03 (pos: 0.030): -1.17810e-01, 3.50640e-02, -3.11165e-02, -2.59474e-02, 1.38685e-01, 1.54658e-01
Node: 04 (pos: 0.040): -1.18345e-01, 1.76231e-02, -1.73064e-02, -1.41194e-02, 1.37704e-01, 1.54552e-01
Node: 05 (pos: 0.051): -1.18883e-01, 7.11341e-04, -3.07660e-03, -1.98927e-03, 1.36726e-01, 1.54458e-01
-
Node: 07 (pos: 0.071): -1.18883e-01, 7.11341e-04, -3.07660e-03, -1.98927e-03, 1.36726e-01, 1.54458e-01
Node: 08 (pos: 0.081): -1.18345e-01, 1.76231e-02, -1.73064e-02, -1.41194e-02, 1.37704e-01, 1.54552e-01
Node: 09 (pos: 0.091): -1.17810e-01, 3.50640e-02, -3.11165e-02, -2.59474e-02, 1.38685e-01, 1.54658e-01
Node: 10 (pos: 0.101): -1.17275e-01, 5.30310e-02, -4.45072e-02, -3.74732e-02, 1.39669e-01, 1.54778e-01
Node: 11 (pos: 0.111): -1.16743e-01, 7.15205e-02, -5.74792e-02, -4.86972e-02, 1.40656e-01, 1.54910e-01
Node: 12 (pos: 0.121): -1.16212e-01, 9.05280e-02, -7.00337e-02, -5.96198e-02, 1.41645e-01, 1.55055e-01

Kernel Weights for neighbours of Node 6 (for each GNN layer):

Node: 00 (pos: 0.000): 1.36381e-06, 2.75942e-04, 7.41157e-03, 2.85949e-02, 1.93480e-09, 3.61992e-11
Node: 01 (pos: 0.010): 1.20517e-06, 6.00491e-03, 3.67410e-02, 9.33486e-02, 2.55809e-09, 3.78620e-11
Node: 02 (pos: 0.020): 1.06396e-06, 6.00672e-02, 1.37946e-01, 2.45554e-01, 3.37298e-09, 3.94433e-11
Node: 03 (pos: 0.030): 9.38398e-07, 2.92443e-01, 3.79752e-01, 5.10040e-01, 4.43546e-09, 4.09270e-11
Node: 04 (pos: 0.040): 8.26857e-07, 7.33027e-01, 7.41180e-01, 8.19256e-01, 5.81704e-09, 4.22975e-11
Node: 05 (pos: 0.051): 7.27875e-07, 9.99494e-01, 9.90579e-01, 9.96051e-01, 7.60876e-09, 4.35402e-11
-
Node: 07 (pos: 0.071): 7.27875e-07, 9.99494e-01, 9.90579e-01, 9.96051e-01, 7.60876e-09, 4.35402e-11
Node: 08 (pos: 0.081): 8.26857e-07, 7.33027e-01, 7.41180e-01, 8.19256e-01, 5.81704e-09, 4.22975e-11
Node: 09 (pos: 0.091): 9.38398e-07, 2.92443e-01, 3.79752e-01, 5.10040e-01, 4.43546e-09, 4.09270e-11
Node: 10 (pos: 0.101): 1.06396e-06, 6.00672e-02, 1.37946e-01, 2.45554e-01, 3.37298e-09, 3.94433e-11
Node: 11 (pos: 0.111): 1.20517e-06, 6.00491e-03, 3.67410e-02, 9.33486e-02, 2.55809e-09, 3.78620e-11
Node: 12 (pos: 0.121): 1.36381e-06, 2.75942e-04, 7.41157e-03, 2.85949e-02, 1.93480e-09, 3.61992e-11
---------------------------------------------------------------------------------------------------------
Positions transformed for neighbours of Node 56 (for each GNN layer):

Node: 00 (pos: 0.000): -1.18883e-01, 7.11341e-04, -3.07660e-03, -1.98927e-03, 1.36726e-01, 1.54458e-01
Node: 01 (pos: 0.010): -1.18345e-01, 1.76231e-02, -1.73064e-02, -1.41194e-02, 1.37704e-01, 1.54552e-01
Node: 02 (pos: 0.020): -1.17810e-01, 3.50640e-02, -3.11165e-02, -2.59474e-02, 1.38685e-01, 1.54658e-01
Node: 03 (pos: 0.030): -1.17275e-01, 5.30310e-02, -4.45072e-02, -3.74732e-02, 1.39669e-01, 1.54778e-01
Node: 04 (pos: 0.040): -1.16743e-01, 7.15205e-02, -5.74792e-02, -4.86972e-02, 1.40656e-01, 1.54910e-01
Node: 05 (pos: 0.051): -1.16212e-01, 9.05280e-02, -7.00337e-02, -5.96198e-02, 1.41645e-01, 1.55055e-01
-
Node: 07 (pos: 0.071): -1.16743e-01, 7.15205e-02, -5.74792e-02, -4.86972e-02, 1.40656e-01, 1.54910e-01
Node: 08 (pos: 0.081): -1.17275e-01, 5.30310e-02, -4.45072e-02, -3.74732e-02, 1.39669e-01, 1.54778e-01
Node: 09 (pos: 0.091): -1.17810e-01, 3.50640e-02, -3.11165e-02, -2.59474e-02, 1.38685e-01, 1.54658e-01
Node: 10 (pos: 0.101): -1.18345e-01, 1.76231e-02, -1.73064e-02, -1.41194e-02, 1.37704e-01, 1.54552e-01
Node: 11 (pos: 0.111): -1.18883e-01, 7.11341e-04, -3.07660e-03, -1.98927e-03, 1.36726e-01, 1.54458e-01
Node: 12 (pos: 0.121): -1.16212e-01, 9.05280e-02, -7.00337e-02, -5.96198e-02, 1.41645e-01, 1.55055e-01

Kernel Weights for neighbours of Node 56 (for each GNN layer):

Node: 57 (pos: 0.576): 7.27875e-07, 9.99494e-01, 9.90579e-01, 9.96051e-01, 7.60876e-09, 4.35402e-11
Node: 58 (pos: 0.586): 8.26857e-07, 7.33027e-01, 7.41180e-01, 8.19256e-01, 5.81704e-09, 4.22975e-11
Node: 59 (pos: 0.596): 9.38398e-07, 2.92443e-01, 3.79752e-01, 5.10040e-01, 4.43546e-09, 4.09270e-11
Node: 60 (pos: 0.606): 1.06396e-06, 6.00672e-02, 1.37946e-01, 2.45554e-01, 3.37298e-09, 3.94433e-11
Node: 61 (pos: 0.616): 1.20517e-06, 6.00491e-03, 3.67410e-02, 9.33486e-02, 2.55809e-09, 3.78620e-11
Node: 50 (pos: 0.505): 1.36381e-06, 2.75942e-04, 7.41157e-03, 2.85949e-02, 1.93480e-09, 3.61992e-11
-
Node: 51 (pos: 0.515): 1.20517e-06, 6.00491e-03, 3.67410e-02, 9.33486e-02, 2.55809e-09, 3.78620e-11
Node: 52 (pos: 0.525): 1.06396e-06, 6.00672e-02, 1.37946e-01, 2.45554e-01, 3.37298e-09, 3.94433e-11
Node: 53 (pos: 0.535): 9.38398e-07, 2.92443e-01, 3.79752e-01, 5.10040e-01, 4.43546e-09, 4.09270e-11
Node: 54 (pos: 0.545): 8.26857e-07, 7.33027e-01, 7.41180e-01, 8.19256e-01, 5.81704e-09, 4.22975e-11
Node: 55 (pos: 0.556): 7.27875e-07, 9.99494e-01, 9.90579e-01, 9.96051e-01, 7.60876e-09, 4.35402e-11
Node: 62 (pos: 0.626): 1.36381e-06, 2.75942e-04, 7.41157e-03, 2.85949e-02, 1.93480e-09, 3.61992e-11
=========================================================================================================
GNN_Layer 0 gradients:
[('0.weight', 1.042842785583931e-09), ('0.bias', 1.0256600492739395e-07), ('2.weight', 1.4239381091189144e-06), ('2.bias', 3.7006468890339683e-07)] 

GNN_Layer 1 gradients:
[('0.weight', 0.00395932600980621), ('0.bias', 0.15091697850869765), ('2.weight', 0.7442370682787479), ('2.bias', 0.20496707951498527)] 

GNN_Layer 2 gradients:
[('0.weight', 0.003974447271617073), ('0.bias', 0.07110239076812032), ('2.weight', 0.409750987879315), ('2.bias', 0.11024336193409195)] 

GNN_Layer 3 gradients:
[('0.weight', 0.0030247232334526916), ('0.bias', 0.10492543313916615), ('2.weight', 0.7137981363643311), ('2.bias', 0.2014504292225819)] 

GNN_Layer 4 gradients:
[('0.weight', 4.495354848466076e-13), ('0.bias', 3.6279659539270985e-10), ('2.weight', 4.828196237331898e-09), ('2.bias', 1.2622921811538938e-09)] 

GNN_Layer 5 gradients:
[('0.weight', 1.1670710879957475e-13), ('0.bias', 6.288086348223084e-12), ('2.weight', 8.174550742007412e-11), ('2.bias', 2.2023972076670994e-11)] 

Evaluation on test dataset:
Step 25, mean loss 0.06885537648479852
Step 50, mean loss 0.054182052590295585
Step 75, mean loss 0.07663416602636416
Step 100, mean loss 0.10534229444334182
Step 125, mean loss 0.29695621409619943
Step 150, mean loss 0.17491171589880378
Step 175, mean loss 0.3356572833787227
Step 200, mean loss 0.2921184084350107
Step 225, mean loss 0.2812086324931518
Unrolled forward losses 8.11962590524875
Unrolled forward base losses 2.5892662621222584
Saved model at models/GNN_norm+mlp+net_CE_E1_xresolution100-200_lr0.0001_n6_s0.001_tw25_unrolling2_time5202158.tar

Epoch 1
Starting epoch 1...
Training Loss (progress: 0.00), 0.2357254403249695, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
Training Loss (progress: 0.08), 0.20572831415711387, [0.001, 0.001, 0.001, 0.001, 0.001, 0.001], [1, 1, 1, 1, 1, 1]
